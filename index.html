<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Download</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
        }
        
        body {
            background-color: #fff;
            color: #202124;
            line-height: 1.5;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 16px;
        }
        
        .header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .app-icon {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            overflow: hidden;
            margin-right: 16px;
            background-color: #fff;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .app-details {
            flex: 1;
        }
        
        .app-name {
            font-size: 24px;
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .developer {
            font-size: 14px;
            color: #018786;
            margin-bottom: 16px;
        }
        
        .install-btn {
            display: block;
            width: 100%;
            background-color: #018786;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 12px;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 16px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .install-btn:hover {
            background-color: #016d6d;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #323232;
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 14px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 1000;
        }
        
        .toast.show {
            opacity: 1;
            visibility: visible;
        }
        
        .spinner {
            display: none;
            width: 40px;
            height: 40px;
            margin: 20px auto;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #018786;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            color: #d32f2f;
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
            display: none;
            padding: 10px;
            background-color: #ffebee;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .manual-download {
            display: none;
            margin-top: 15px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="app-info">
            <div class="app-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                    <circle cx="24" cy="24" r="20" fill="#018786"/>
                    <path fill="#fff" d="M24 12l-2.83 2.83L32.34 26 21.17 37.17 24 40l16-16z"/>
                </svg>
            </div>
            <div class="app-details">
                <h1 class="app-name">Arabic Chat</h1>
                <div class="developer">App Developer</div>
            </div>
        </div>
        
        <button id="installBtn" class="install-btn">Install</button>
        <div id="spinner" class="spinner"></div>
        <div id="errorMessage" class="error-message"></div>
        
        <div id="manualDownload" class="manual-download">
            <p>If download doesn't start automatically:</p>
            <a id="manualLink" href="#" class="install-btn">Click here to download</a>
        </div>
    </div>
    
    <div id="toast" class="toast">Preparing download...</div>

    <script>
        document.getElementById('installBtn').addEventListener('click', async function() {
            const toast = document.getElementById('toast');
            const spinner = document.getElementById('spinner');
            const installBtn = this;
            const errorMessage = document.getElementById('errorMessage');
            const manualDownload = document.getElementById('manualDownload');
            const manualLink = document.getElementById('manualLink');
            
            // Reset UI
            errorMessage.style.display = 'none';
            manualDownload.style.display = 'none';
            errorMessage.textContent = '';
            
            // Show loading states
            toast.textContent = 'Preparing download...';
            toast.classList.add('show');
            spinner.style.display = 'block';
            installBtn.disabled = true;
            installBtn.textContent = 'Downloading...';
            
            // Your actual APK URL here (replace with your real URL):
            const apkUrl = 'https://your-server.com/path/to/ArabicChat.apk';
            const fileName = 'Arabic Chat.apk';
            
            // Set manual download link
            manualLink.href = apkUrl;
            manualLink.download = fileName;
            
            try {
                // Try simple download method first
                const a = document.createElement('a');
                a.href = apkUrl;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                
                // Check if download started
                let downloadStarted = false;
                
                // Fallback methods if simple download fails
                setTimeout(async () => {
                    if (downloadStarted) return;
                    
                    try {
                        // Try fetch API method
                        toast.textContent = 'Trying alternative download method...';
                        const response = await fetch(apkUrl);
                        if (!response.ok) throw new Error('Server response not OK');
                        
                        const blob = await response.blob();
                        const blobUrl = window.URL.createObjectURL(blob);
                        
                        const a2 = document.createElement('a');
                        a2.href = blobUrl;
                        a2.download = fileName;
                        document.body.appendChild(a2);
                        a2.click();
                        
                        // Cleanup
                        setTimeout(() => {
                            window.URL.revokeObjectURL(blobUrl);
                            document.body.removeChild(a2);
                        }, 100);
                        
                        downloadStarted = true;
                        toast.textContent = 'Download started (method 2)...';
                        
                    } catch (fetchError) {
                        console.error('Fetch method failed:', fetchError);
                        // Final fallback - show manual download option
                        manualDownload.style.display = 'block';
                        toast.textContent = 'Please use manual download';
                        throw new Error('All automatic methods failed');
                    }
                }, 2000);
                
                // Success case
                downloadStarted = true;
                toast.textContent = 'Download started...';
                
                setTimeout(() => {
                    resetUI();
                }, 3000);
                
            } catch (error) {
                errorMessage.textContent = 'Error: Could not start automatic download. Please use the manual download link below.';
                errorMessage.style.display = 'block';
                manualDownload.style.display = 'block';
                toast.textContent = 'Download failed - use manual link';
                console.error('Download error:', error);
                
                setTimeout(() => {
                    resetUI();
                }, 5000);
            }
            
            function resetUI() {
                spinner.style.display = 'none';
                installBtn.disabled = false;
                installBtn.textContent = 'Install';
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 1000);
            }
        });
    </script>
</body>
</html>
